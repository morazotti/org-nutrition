* Tasks

** DONE [#A] capturar comidas do usu√°rio
:PROPERTIES:
:ID:       7a2b9c3d-4e5f-6a7b-8c9d-0e1f2a3b4c5d
:END:
Aqui, deve haver fun√ß√µes ~org-nutrition-food-capture~ e ~org-nutrition-recipe-capture~ que criam, dentro de uma heading ~* Foods~ ou ~* Recipes~ no pr√≥prio ~nutrition.org~, uma subheading com o nome da comida que o usu√°rio chamou, com propriedades de macro nutrientes por por√ß√£o definida pelo usu√°rio (calories, fats, carbs, protein, e se √© alimento ou receita). A por√ß√£o padr√£o √© 100g. Se um usu√°rio cadastrar, por exemplo, ~peito de frango~, deve-se buscar primeiramente no heading em quest√£o, depois na API, e s√≥ ent√£o pedir para o usu√°rio catalogar.
*** DONE [#B] fun√ß√£o que cataloga uma certa entrada de uma tabela em um heading de ~* Foods and recipes~.
:PROPERTIES:
:ID:       b5c6d7e8-9f0a-1b2c-3d4e-5f6a7b8c9d0e
:END:
Ao criar uma entrada com capture, no final deve-se perguntar ao usu√°rio se ele deseja salvar aquela entrada em ~* Foods and recipes~, reduzindo o uso de APIs.
*** DONE [#B] Adicionar lista de emojis em na categoria
:PROPERTIES:
:ID:       c1d2e3f4-a5b6-7c8d-9e0f-1a2b3c4d5e6f
:END:
O padr√£o √© que cada alimento tenha uma categoria inserida -- considerando carne, frango, peixe, latic√≠nios, vegetais, legumes, frutas, snacks. A categoria deve ser um emoji baseado em um alist como o exemplo
#+begin_src emacs-lisp :tangle yes
  (defvar org-nutrition--categories-alist
    '(("meat" . üçñ)
      ("chicken" . üêî)
      ("fish" . üêü)
      ("vegetable" . ü•ï)
      ("greens" . ü•¨)
      ("fruits" . üçì)
      ("snacks" . üçï)
      ...
    )
#+end_src
e assim por diante. O usu√°rio deve poder escolher um da lista ao capturar uma comida.

** DONE [#A] capturar receitas do usu√°rio
:PROPERTIES:
:ID:       45667c8801a00fd0f0e87203fafecdc4
:END:
O usu√°rio deve poder lan√ßar ~org-nutrition-recipe-capture~ para salvar uma receita. Nela, o usu√°rio entra com os alimentos j√° capturados, alterando apenas o por√ß√£o individual. Algo como
#+begin_src org
  ,* Lingui√ßa ao molho
    :PROPERTIES:
    :INGREDIENT: [Lingui√ßa toscana][350g]
    :INGREDIENT: [Tomate pelado][400g]
    :END:
    receita foo bar baz
#+end_src
Ele linka poss√≠veis ingredientes (foods) do usu√°rio e calcula corretamente os macros. Pode ser inserida normalmente ao fazer um ~org-nutrition-capture~.

** DONE [#C] Colocar linha separando a total do restante
:PROPERTIES:
:ID:       d4e5f6a7-b8c9-0d1e-2f3a-4b5c6d7e8f9a
:END:
** DONE [#B] desacoplar de um minor mode e utilizar chamadas externas
:PROPERTIES:
:ID:       e5f6a7b8-c9d0-1e2f-3a4b-5c6d7e8f9a0b
:END:
** TODO [#B] criar fun√ß√µes √∫teis para o usu√°rio utilizar com org-ql e coisas similares
:PROPERTIES:
:ID:       f6a7b8c9-d0e1-2f3a-4b5c-6d7e8f9a0b1c
:END:
** TODO [#A] adicionar uma op√ß√£o de calcular op√ß√µes nutricionais
:PROPERTIES:
:ID:       a7b8c9d0-e1f2-3a4b-5c6d-7e8f9a0b1c2d
:END:
Se houver uma tabela com o nome definido em ~org-nutrition-body-information~, ele deve ser capaz de inferir a taxa basal de calorias etc de um usu√°rio. Deve ter uma propriedade com "loss/keep/gain" permitindo o usu√°rio definir se est√° em uma dieta de emagrecimento, ganho de massa etc. As informa√ß√µes da √∫ltima linha dessa tabela devem ser as que valem - visto que o usu√°rio pode ir alterando sua massa aos poucos l√°.

O c√°lculo √© feito dessa maneira:


#+begin_src emacs-lisp
  (setq-local imc (/ peso (* 0.01 0.01 altura altura)))
  (setq-local bmr 
    (* atividade (+ (* 10 peso) (* 6.25 altura) (* -5 idade) 5)))
  (- bmr 300) ;; para emagrecer
#+end_src

A tabela de atividade √© a seguinte:
| Estilo de vida | Frequ√™ncia                           | Fator de atividade |
| Sedent√°rio     | Trabalho sentado / nenhuma atividade |                1.2 |
| Pouco ativo    | Exerc√≠cio 1-3 dias/semana            |              1.375 |
| Moderado       | Exerc√≠cio 3-5 dias/semana            |               1.55 |
| Muito ativo    | Exerc√≠cio 6-7 dias/semana            |              1.725 |
| Extremo        | Exerc√≠cio 2x/dia                     |                1.9 |

Para emagrecer, nos mantemos \(\sim300\)kcal abaixo da taxa basal. Para ganhar massa, ficamos \(\sim300\)kcal acima da taxa basal.
** TODO [#B] colocar isso tudo num template do org-capture -- se poss√≠vel
:PROPERTIES:
:ID:       00b1f98c0ac4aa0a7bb41051803f0b32
:END:
** DONE [#B] m√©dias por dia mensais e anuais
:PROPERTIES:
:ID:       635c637d0e29f71e295d2152ae832041
:END:
Gostaria que no heading do m√™s, fosse introduzida e atualizada uma tabela que apresenta o resumo de cada dia (calorias, macros, pesos) e mostrasse como compilado as m√©dias por dia. 
** DONE [#C] Deixar tudo em ingles
:PROPERTIES:
:ID:       c16d244007104c536ed25fd613cb1e19
:END:


#+begin_reasoning
**Defining the Function*

I'm currently working on defining the function, =org-nutrition--generate-heading-id=, which will generate the desired hash. My focus is on ensuring it correctly takes the Org mode heading name as input, and subsequently compute a hash value from it. I need to make sure the hashing process is efficient and reliable.



#+end_reasoning

Aqui est√° uma fun√ß√£o que gera um hash MD5 baseado no t√≠tulo do heading atual e define a propriedade =ID=.

#+begin_src emacs-lisp
(defun org-nutrition--generate-id-from-heading ()
  "Gera um ID determin√≠stico (hash MD5) baseado no t√≠tulo do heading atual."
  (interactive)
  (when (org-at-heading-p)
    (let* ((title (org-get-heading t t t t)) ;; t t t t remove TODOs, tags, cookies e prioridade
           (hash (md5 title)))
      (org-set-property "ID" hash)
      (message "ID gerado para '%s': %s" title hash))))
#+end_src

#+RESULTS:
: org-nutrition--generate-id-from-heading

Para usar, posicione o cursor sobre um heading e execute =M-x org-nutrition-generate-id-from-heading=.
* Bugs
** TODO [#C] Linhas esp√∫rias sob as tabelas de resumo do m√™s e do ano.
:PROPERTIES:
:ID:       c26c4bec790c5e5cafa35b7b174b1afa
:END:
